# wechaty-room-clock
[![Wechaty Plugin Contrib](https://img.shields.io/badge/Wechaty%20Plugin-wechaty--room--clock-brightgreen.svg)](https://github.com/isboyjc/wechaty-room-clock) [![Powered by Wechaty](https://img.shields.io/badge/Powered%20By-Wechaty-brightgreen.svg)](https://github.com/Wechaty/wechaty)

integral, clock

ç§¯åˆ†ï¼Œæ‰“å¡ç­¾åˆ°

## å¼€å§‹

### ç®€ä»‹

çœ‹åå­—ï¼ŒåŠŸèƒ½ä¸éš¾çŒœåˆ°ï¼Œåœ¨ç¾¤èŠä¸­æ‰“å¡ç­¾åˆ°ï¼Œæ¯æ¬¡æ‰“å¡ç­¾åˆ°åç´¯è®¡æ‰“å¡ç­¾åˆ°æ¬¡æ•°+1ï¼Œç§¯åˆ†+1ï¼Œæ¯æ—¥åªå¯æ‰“å¡ä¸€æ¬¡ï¼Œæ‰“å¡æ€»æ•°/ç§¯åˆ†æ€»æ•°/æ‰“å¡æ—¥å¿—ç­‰ç­‰

ä½ å¯èƒ½è§‰å¾—è¿™äº›æ“ä½œéœ€è¦ç”¨åˆ°æ•°æ®åº“ï¼Œä½†æ˜¯åœ¨æˆ‘çš„ç†è§£ä¸­ï¼Œå¾®ä¿¡æœºå™¨äººè¶Šç®€å•è¶Šä¾¿æ·è¶Šå¥½ï¼Œè€Œå¾®ä¿¡ç¾¤èŠçš„æ•°æ®é‡ä¸æ˜¯å¾ˆå¤§ï¼Œä¸€ä¸ªæ’ä»¶çš„ä½¿ç”¨ï¼Œéœ€è¦é¢å¤–é…ç½®å¾ˆå¤šä¸œè¥¿æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œæ‰€ä»¥ï¼Œæ­¤æ’ä»¶é‡‡ç”¨äº†æœ¬åœ°å­˜å‚¨ï¼Œç”¨äº†ä¸€ä¸ªä¸‰æ–¹è½»é‡åŒ–çš„åŸºäº `Node` çš„ `JSON` æ–‡ä»¶æ•°æ®åº“ `LOWDB`ï¼Œé¿å…äº†æ•°æ®åº“è¿™ä¸€ç¹ççš„é…ç½®

æ’ä»¶ä¼šè‡ªåŠ¨åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª `[æœºå™¨äººåå­—].clock-logs` çš„æ–‡ä»¶å¤¹ï¼Œç”¨ä»¥å­˜æ”¾æ•°æ®

å…¶ä¸­ `clock-logs-[å¹´ä»½].json` æ–‡ä»¶å­˜å‚¨çš„æ˜¯æ‰“å¡æ—¥å¿—ï¼Œä¸ºé¿å…è¯»å†™æ“ä½œæ•°æ®é‡è¿‡å¤§äº§ç”Ÿçš„è´Ÿè·ï¼Œæ‰€ä»¥æ¯å¹´ä¼šç”Ÿæˆå¯¹åº”çš„ `json` æ–‡ä»¶ï¼Œè¿™æ ·æ¯ä¸ªç¾¤èŠä¸Šé™æ˜¯ 500 äººï¼Œä»¥5ä¸ªç¾¤èŠä¸ºåŸºç¡€ï¼Œä¸€å¹´çš„æ‰“å¡æ•°æ®é‡ä¹Ÿä¸ä¼šå¤ªå¤§

å…¶ä¸­ `clock-logs-main.json` æ–‡ä»¶ä¸ºä¸»æ–‡ä»¶ï¼Œå­˜å‚¨çš„æ˜¯å¯¹åº”ç¾¤èŠ/å¯¹åº”ç”¨æˆ·çš„æ‰“å¡ç­¾åˆ°æ•°æ®ç­‰ç­‰

å½“ç„¶ï¼Œå¦‚æœä½ æœ‰æ›´å¥½çš„æƒ³æ³•ï¼Œè¯·åŠ¡å¿…å‘ŠçŸ¥å“¦

### å®‰è£…

```txt
npm install wechaty-room-clock

or

yarn add wechaty-room-clock
```

### ä½¿ç”¨

```js
const WechatyRoomClock = require("wechaty-room-clock")

bot.use(WechatyRoomClock(options))
```

å¦‚ä¸Šæ‰€ç¤º

ä½¿ç”¨æ’ä»¶åªè¦æŒ‰éœ€ä¼ å…¥é…ç½®å¯¹è±¡ `options` å³å¯

| Options å‚æ•°å±æ€§  | ç±»å‹             | ç®€ä»‹                                                         |
| ----------------- | ---------------- | ------------------------------------------------------------ |
| keyword           | String\|Array    | è§¦å‘ç­¾åˆ°çš„å…³é”®å­—ï¼Œåªæœ‰ä¸€ä¸ªå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ç±»å‹ï¼Œå¤šä¸ªå…³é”®å­—ä½¿ç”¨æ•°ç»„ç±»å‹ï¼Œé»˜è®¤ä¸º ["ç­¾åˆ°", "æ‰“å¡"] |
| success           | String\|Function           | æ‰“å¡æˆåŠŸæç¤ºè¯¥ç”¨æˆ·çš„ä¸€å¥è¯ï¼Œå¯ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•°ç±»å‹ï¼Œå‡½æ•°ç±»å‹æ—¶ï¼Œæœ‰ä¸€ä¸ªå‚æ•°dataï¼Œå³å½“å‰ç¾¤æˆå‘˜åœ¨æœ¬åœ°æ•°æ®åº“ä¸­çš„æ•°æ®å¯¹è±¡ï¼Œå‡½æ•°æœ€ç»ˆéœ€è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²function(data){return ...}ï¼Œæ­¤é¡¹é»˜è®¤å€¼è¯·çœ‹ä¸‹æ–‡ç¤ºä¾‹ |
| repeat   | String\|Function            | é‡å¤æ‰“å¡æ—¶æç¤ºè¯¥ç”¨æˆ·çš„ä¸€å¥è¯ï¼Œå¯ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•°ç±»å‹ï¼Œå‡½æ•°ç±»å‹æ—¶ï¼Œæœ‰ä¸€ä¸ªå‚æ•°dataï¼Œå³å½“å‰ç¾¤æˆå‘˜åœ¨æœ¬åœ°æ•°æ®åº“ä¸­çš„æ•°æ®å¯¹è±¡ï¼Œå‡½æ•°æœ€ç»ˆéœ€è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²function(data){return ...}ï¼Œæ­¤é¡¹é»˜è®¤å€¼ä¸º â€œä»Šæ—¥å·²ç­¾åˆ°ï¼Œè¯·å‹¿é‡å¤ç­¾åˆ°â€ |

å‚æ•° `success` å’Œ `repeat` ä¸ºå‡½æ•°ç±»å‹æ—¶è¡Œå‚ `data` ç¤ºä¾‹

```js
{
  	// è¯¥ç”¨æˆ·å¾®ä¿¡id
  	"CONTACTID": "wxid_nrsh4yc8yupm22",
  	// è¯¥ç”¨æˆ·æ˜µç§°
  	"CONTACTNAME": "isboyjc",
    // è¯¥ç”¨æˆ·æ‰“å¡æ€»æ•°
  	"CLOCKNUM": 170,
  	"CLOCKINFO": {
      // è¯¥ç”¨æˆ·2020å¹´æ‰“å¡æ€»æ•°
     	"2020": 69,
      // è¯¥ç”¨æˆ·2019å¹´æ‰“å¡æ€»æ•°
     	"2019": 101
  	},
    // è¯¥ç”¨æˆ·ç§¯åˆ†
  	"INTEGRALNUM": 170
}
```



### ç¤ºä¾‹

```js
const { Wechaty } = require("wechaty")
const { PuppetPadplus } = require("wechaty-puppet-padplus")
const Qrterminal = require("qrcode-terminal")
const WechatyRoomClock = require("wechaty-room-clock")

const bot = new Wechaty({
  puppet: new PuppetPadplus({
    // æœºå™¨äººpadplusåè®®token
    token: PUPPET_PADPLUS_TOKEN,
  }),
  // æœºå™¨äººåå­—
  name: ROBOT_NAME,
})

let options = {
  // æ­¤å¤„ä¸ºé»˜è®¤é¡¹é…ç½®ï¼Œä¹Ÿå¯ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²
  keyword: ["ç­¾åˆ°", "æ‰“å¡"],
  // æ­¤å¤„ä¸ºé»˜è®¤é¡¹é…ç½®ï¼Œä¹Ÿå¯ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²
  success: (data) => {
    let str = "\nç­¾åˆ°æˆåŠŸ\n"
    Object.keys(data.CLOCKINFO).map(
      (v) => (str += `${v}å¹´ç´¯è®¡ç­¾åˆ°${data.CLOCKINFO[v]}æ¬¡\n`)
    )
    return str + `å…±ç´¯è®¡ç­¾åˆ°${data.CLOCKNUM}æ¬¡\næ‹¥æœ‰${data.INTEGRALNUM}ç§¯åˆ†`
  },
  // æ­¤å¤„ä¸ºé»˜è®¤é¡¹é…ç½®ï¼Œä¹Ÿå¯ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²
  repeat: (data) => `ä»Šæ—¥å·²ç­¾åˆ°ï¼Œè¯·å‹¿é‡å¤ç­¾åˆ°`,
}

// ä½¿ç”¨æ’ä»¶
bot.use(WechatyRoomClock(options))

bot
  .on("scan", (qrcode, status) => {
    Qrterminal.generate(qrcode, { small: true })
  })
  .start()

```

å¦‚ä¸Šæ‰€ç¤ºï¼Œå¦‚æœä½ å¯¹é»˜è®¤é…ç½®è®¤åŒçš„è¯ï¼Œåªéœ€è¦è°ƒç”¨ `bot.use(WechatyRoomClock())` è¿™ä¸€è¡Œä»£ç å°±OKäº†ï¼Œæ˜¯ä¸æ˜¯æ–¹ä¾¿å¿«æ·å‘¢ğŸ˜„



### æœ€å

æ‰«æäºŒç»´ç ï¼ŒåŠ åœˆå­å¾®ä¿¡ï¼Œå¯è¿›äº¤æµç¾¤å“¦ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼Œèµ¶å¿«æ¥è¯•è¯•å§

<img src="https://gitee.com/IsboyJC/PictureBed/raw/master/other/asdakshdajshdas1.jpeg" width="200" height="200" alt="å›¾ç‰‡åç§°" align=left />

![image-20200705213657340](https://gitee.com/IsboyJC/PictureBed/raw/master/other/image-20200705213657340.png)